# 9장 스프링 프로젝트 시작하기

- 유연하게 설계된 스프링을 잘 활용하기 위해 아키텍처의 종류와 프로젝트 구성 방식에 대해 알아본다.

## 9.1 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션

- 스프링은 자바 언어를 사용하는 모든 종류의 프로젝트에 적용할 수 있지만, 주로 자바 엔터프라이즈 환경에서 실행되는 애플리케이션 개발을 목적으로 사용된다.

### 9.1.1 클라이언트와 백엔드 시스템

- 엔터프라이즈 애플리케이션은 클라이언트로서 다른 서비스를 요청할 수도 있고, 백엔드 시스템(EIS)과 연동하여 서비스 제공자의 역할을 수행할 수도 있다.
  <img alt="Image" src="https://github.com/user-attachments/assets/a73de69b-9cc8-48f4-a16c-e214260e74c7" />

### 9.1.2 애플리케이션 서버

- 스프링 애플리케이션을 자바 서버 환경에 배포하려면 JavaEE 기반 서버가 필요하다.
    - 경량급 WAS 또는 서블릿/JSP
        - 웹 모듈의 배포만 가능하다.
        - 스프링은 기본적으로 톰캣(Tomcat)이나 제티(Jetty) 같은 서블릿 컨테이너만으로도 대부분의 핵심기능을 이용할 수 있다.
    - 웹 애플리케이션 서버(WAS)
        - 다양한 형태의 모듈로 배포 가능하다.
        - 성능 면에서 크게 차이가 나지 않는다.
        - 안정성이나 관리 기능, 모니터링 기능이 뛰어나서 여러 대의 서버를 동시에 운영할 때 유리하다.
        - 자바 엔터프라이즈 버전(JavaEE) 표준을 최대한 활용할 수 있다.
- 스프링소스 tcServer
    - 자바 서버는 웹 모듈만 지원하는 서블릿 컨테이너인 아파치 톰캣을 가장 많이 사용한다.
    - 이를 기반으로 스프링 소스에서는 스프링 애플리케이션에 최적화된 tcServer를 개발했다.
        - 고급 서버 관리 기능, 배포 기능, 진단 기능 등 개발과 운영에서 필요한 중요한 기능들을 제공한다.

### 9.1.3 스프링 애플리케이션의 배포 단위

- 스프링의 배포 단위 세 가지
    - 독립 웹 모듈
        - 스프링은 일반적으로 war로 패키징된 독립 웹 모듈로 배포된다.
        - 서블릿 컨테이너를 사용한다면 독립 웹 모듈이 유일한 방법이다.
    - 엔터프라이즈 애플리케이션
        - 필요에 따라 확장자가 `ear`인 엔터프라이즈 애플리케이션으로 패키징해서 배포할 수 있다.
        - 하나 이상의 웹 모듈과 별도로 분리된 공유 가능한 스프링 컨텍스트를 엔터프라이즈 애플리케이션으로 묶어주는 방법이다.
    - 백그라운드 서비스 모듈
        - 스프링으로 만든 애플리케이션이 UI를 가질 필요는 없고, 서버 내에서 백그라운드 서비스처럼 동작할 필요가 있을 때 `rar` 패키지 방법을 사용할 수 있다.

## 9.2 개발도구와 환경

### 9.2.1 JavaSE와 JavaEE

- JavaSE/JDK
    - 스프링 3.0은 JavSE 5 버전에 추가된 기능과 JDK 6.0의 API를 사용하고 있기 때문에 최소 JDK 5.0 이상 버전이 필요하다.
- JavaEE/J2EE
    - 스프링 3.0은 JDK 6.0과 JavaEE 5.0을 기준으로 개발됐지만, 주요 기능은 JDK 5.0에서 동작하는 J2EE 1.4 버전과 호환된다.

### 9.2.2 IDE

- 통합개발환경(IDE)은 개발 과정에 필요한 작업을 한 곳에서 처리할 수 있도록 도와주는 통합 도구이다.
- 자바의 대표적인 IDE 들은 자바 엔터프라이즈 개발을 지원하고, 스프링 지원 기능도 제공한다.

### 9.2.3 SpringSource Tool Suite

- STS(SpringSource Tool Suite)은 이클립스를 기반으로 스프링 지원 플러그인과 관련 도구를 모아서 스프링 개발에 최적화 되도록 만들어진 IDE다.
- SpringIDE 플러그인
    - SpringIDE란, 스프링 개발에 유용한 기능을 제공하는 플러그인 모음으로 편리한 기능과 도구를 제공한다.
    - XML 에디터의 자동완성 기능을 제공한다.
        - 빈 클래스 이름 자동완성
            - 빈의 `class` 속성이나 프로퍼티를 입력 할 때, 클래스 이름에 대한 자동완성을 지원한다.
        - 빈 설정 오류 검증
            - 자바 코드를 작업할 때 실시간으로 컴파일 오류를 분석해서 표시해준다.
            - 이 기능을 잘 활용하면 빈 설정에 대한 오류를 애플리케이션 배포 없이 사전에 파악할 수 있습니다.
        - 프로젝트 생성, 설정파일 생성, 빈 등록 위저드
            - 스프링 프로젝트를 쉽게 생성할 수 있는 위저드를 제공한다.
            - XML 설정 파일의 스키마 선언을 간편하게 추가 또는 수정할 수 있다.
    - 빈 의존관계 그래프
        - XML 설정 파일을 분석해 빈 간의 참조 관계와 프로퍼티 구성을 한눈에 파악할 수 있게 표시해준다.
    - AOP 적용 대상 표시
        - XML 설정에서 AOP 포인트컷의 대상이 되는 빈을 확인할 수 있게 표시해준다.
        - 불필요한 빈이 AOP 대상이 되는 것을 방지하기 위해서 두 가지 방법이 있다.
            - 포인트컷 표현식에서 제외되도록 이름을 변경한다.
            - 포인트컷에 적용할 패키지를 지정하여 대상 범위를 제한한다.
    - 기타 지원 기능
        - 스프링 2.5부터는 애노테이션 기반의 빈 설정을 지원하지만, 서비스 빈 설정 등 상황에 따라 XML 설정과 함께 혼용하여 사용할 수 있다.
- STS 플러그인
    - SpringIDE에 더해, 스프링 애플리케이션의 서버 배치 등 다양한 추가 기능을 제공한다.
    - 대시보드 화면과 자주 발생하는 예외에 대한 지식 베이스(Knowledge Base) 검색 기능도 지원한다.
- 기타 플러그인
    - M2Eclipse
        - Maven 기반 의존성 관리를 지원하는 이클립스 플러그인으로, STS에 기본 포함되어 있다.
    - AJDT(AspectJ Development)
        - AspectJ AOP 개발을 지원하는 툴이다.
    - VMCI(Virtual Machine Core Integration)
        - VMWare 서버 또는 워크스테이션과 연동을 지원한다.
    - 이클립스 표준 플러그인
        - WTP(Web Tools Platform), EMP(Eclipse Modeling Project), Mylyn, DSDP(Device Software Development Platform) 등
          다양한 개발 환경을 지원한다.

### 9.2.4 라이브러리 관리와 빌드 툴

- 라이브러리 관리의 어려움
    - 많은 의존 라이브러리가 필요하지만, 모든 라이브러리를 항상 사용하는 것은 아니기 때문에 적절한 선택이 중요합니다.
    - 라이브러리는 다양한 버전이 존재하며, 버전이 맞지 않으면 컴파일 오류나 런타임 오류가 발생할 수 있다.
    - 복잡한 의존 관계 속에서는 동일한 라이브러리의 서로 다른 버전이 동시에 필요한 경우도 발생한다.
    - 자바는 모듈 개념이 존재하지 않아, 재패키징 기법을 사용해 이러한 충돌을 피할 수 있다.
        - 재패키징은 동일한 라이브러리의 서로 다른 버전을 각각 다른 패키지로 변경하여 충돌을 방지하는 방식이다.
- 라이브러리 선정
    - 스프링 프로젝트를 시작할 때는 먼저 필요한 기능을 정리하고, 이를 지원하는 기술과 라이브러리를 결정해야 한다.
    - 스프링 모듈
        - 스프링은 다양한 모듈로 구성되어 있기 때문에 프로젝트에 필요한 기능을 기준으로 모듈을 선택한다.
        - 모듈 간의 의존관계에 따라 필수 의존 모듈과 선택적 모듈을 구분해 선정해야 한다.
    - 라이브러리
        - 스프링 모듈은 서로다른 모듈 외에도 외부 라이브러리나 표준 API에 의존하는 경우도 있다.
        - 스프링 모듈과 의존하는 라이브러리의 종류와 특징에 맞는 라이브러리를 선택해야 한다.
    - 어떤 라이브러리를 사용할지 명확하지 않을 경우, 시행착오를 통해 적절한 조합을 찾아가는 방식도 필요할 수 있다.
    - 최소한의 모듈과 라이브러리로 시작해서, 개발 진행 중에 필요한 라이브러리만 점진적으로 추가하는 방식을 권장합니다.
    - 필요한 라이브러리가 없으면 컴파일 오류나 런타임 예외가 발생하지만, 불필요한 라이브러리는 즉각적인 문제를 일으키지는 않아도 다음과 같은 잠재적인 문제를 유발할 수 있다.
        - 모듈 파일의 크기를 증가신킨다.
        - 의존성 관리가 복잡해진다.
- 빌드 툴과 라이브러리 관리
    - IDE에서는 자동 빌드 기능과 관련 빌더를 추가하면 복잡한 빌드 작업도 간편하게 수행할 수 있다.
    - 하지만 IDE가 없는 환경에서도 일관된 빌드를 유지하기 위해, Maven 같은 독립적인 빌드 툴의 사용이 권장된다.
    - Maven은 POM을 기반으로 선언적인 방식으로 빌드와 프로젝트 관리를 수행한다.
        - POM에 필요한 의존 라이브러리만 선언해두면, Maven이 원격 저장소에서 자동으로 라이브러리를 다운로드하여 사용할 수 있도록 해준다.
        - 전이적(Transitive) 의존성 관리 기능을 통해, 지정한 라이브러리가 필요로 하는 다른 라이브러리들도 자동으로 함께 다운로드된다.
    - 스프링의 모든 모듈은 POM 정보를 갖고 있지만 대부분 선택 라이브러리기 때문에 명시적으로 POM에 선언해줘야 한다.
    - 스프링의 모든 모듈은 POM 정보를 갖고 있으나 대부분 선택적이므로, 실제 필요한 모듈은 명시적으로 POM에 선언해야 한다.
    - 라이브러리 선택에 대한 수고가 완전히 사라지는 것은 아니지만, 라이브러리 그룹을 구성하고 이를 POM에 반영해두면 효율적인 관리가 가능하다.
      <img alt="Image" src="https://github.com/user-attachments/assets/acecae65-fa39-4e91-a1e0-6f659cdc35bc" />
- 스프링 모듈의 두 가지 이름과 리포지토리
    - 스프링의 `core` 모듈 jar 파일을 보면 두 가지 이름 형식이 존재한다.
        - `spring-core-3.0.7.RELEASE.jar`
            - Maven 명명 규칙
            - 아티팩트 ID와 버전을 조합해 파일명으로 사용한다.
        - `org.springframework.core-3.0.7.RELEASE.jar`
            - OSGi 모듈 명명 규칙
            - 스프링의 모든 모듈은 OSGi 호환 모듈로, OSGi 플랫폼에서 사용하지 않더라도 OSGi 스타일의 이름 사용을 권장한다.
    - 두 파일은 내용이 동일하지만 배포 기술에 따라 관례적으로 이름만 다르게 사용하는 것이다.
    - OSGi 형식의 이름을 사용하는 스프링 모듈을 사용할 경우, Maven 대신 스프링소스의 엔터프라이즈 번들 리포지토리를 통해 의존성을 관리해야 한다.

## 9.3 애플리케이션 아키텍처

- 아키텍처는 다양한 방식으로 정의될 수 있지만, 가장 단순한 정의는 "하나의 시스템 내부 구성요소들이 어떤 책임을 가지며, 어떤 방식으로 관계를 맺고 동작하는지를 규정"한 것이다.
- 아키텍처는 단순한 정적인 구조를 넘어서, 그 구조 안에서 일어나는 동적인 행위와도 깊은 관련이 있다.

### 9.3.1 계층형 아키텍처

- 서로 다른 모듈 간의 결합도가 높을 때 발생할 수 있는 문제를 방지하기 위해 인터페이스 등을 활용해 유연한 경계를 만들고 모듈 간 의존성을 낮추는 구조적 분리가 필요하다.
- 아키텍처와 SoC
